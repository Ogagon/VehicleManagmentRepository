@model MonoTask.MVC.ViewModels.VehicleModel.VehicleModelIndexViewModel

@{
    ViewBag.Title = "Vehicle Models administration panel";
}

<h2>Vehicle Model administration panel</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
@if (TempData["Message"] != null)
{
    <div class="alert alert-@TempData["MessageType"]">
        @TempData["Message"]
    </div>
}
<form method="get" action="@Url.Action("Index")">
    @Html.DropDownList("makeId", Model.SelectMakes, "All makes", new { @class = "form-control", onchange = "submit()" })
    <input type="text" name="searchTerm" value="@Model.Query.CurrentSearchTerm" placeholder="Search..." />
    <button type="submit">Search</button>
    <a href="@Url.Action("Index")">Clear Filter</a>
</form>
<table class="table">
    <tr>
        <th>
            @Html.ActionLink("Make", "Index", new
       {
           sortColumn = "Make",
           sortDescending = Model.Query.CurrentSortColumn == "Make.Name"
                      ? !Model.Query.CurrentSortDescending
                      : false,
           searchTerm = Model.Query.CurrentSearchTerm,
           makeId = Model.Query.CurrentMakeId

       })
        </th>
        <th>
            @Html.ActionLink(Html.DisplayNameFor(m => m.DataModel.Name).ToString(), "Index", new
       {
           sortColumn = nameof(MonoTask.MVC.ViewModels.VehicleModelViewModel.Name),
           sortDescending = Model.Query.CurrentSortColumn == nameof(MonoTask.MVC.ViewModels.VehicleModelViewModel.Name)
                      ? !Model.Query.CurrentSortDescending
                      : false,
           searchTerm = Model.Query.CurrentSearchTerm,
           makeId = Model.Query.CurrentMakeId

       })

        </th>
        <th>
            @Html.ActionLink(Html.DisplayNameFor(m => m.DataModel.Abrv).ToString(), "Index", new
       {
           sortColumn = nameof(MonoTask.MVC.ViewModels.VehicleModelViewModel.Abrv),
           sortDescending = Model.Query.CurrentSortColumn == nameof(MonoTask.MVC.ViewModels.VehicleModelViewModel.Abrv)
                      ? !Model.Query.CurrentSortDescending
                      : false,
           searchTerm = Model.Query.CurrentSearchTerm,
           makeId = Model.Query.CurrentMakeId

       })

        </th>
        <th>Actions</th>
    </tr>

    @foreach (var item in Model.PagingResult.Items)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Make.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Abrv)
            </td>
            <td>
                @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                @Html.ActionLink("Delete", "Delete", new { id = item.Id })
            </td>
        </tr>
    }

</table>
<!-- Pagination -->
@if ((int)Model.PagingResult.TotalItems > (int)Model.PagingResult.PageSize)
{
    var totalPages = Model.PagingResult.TotalPages;
    <div class="pagination">
        @if (Model.PagingResult.CurrentPage > 1)
        {
            <a href="@Url.Action("Index", new
                {
                    page = Model.PagingResult.CurrentPage - 1,
                    sortColumn = Model.Query.CurrentSortColumn,
                    sortDescending = Model.Query.CurrentSortDescending,
                    searchTerm = Model.Query.CurrentSearchTerm
                })">Prev</a>
        }

        Page @Model.PagingResult.CurrentPage of @totalPages

        @if (Model.PagingResult.CurrentPage < totalPages)
        {
            <a href="@Url.Action("Index", new
                {
                    page = Model.PagingResult.CurrentPage + 1,
                    sortColumn = Model.Query.CurrentSortColumn,
                    sortDescending = Model.Query.CurrentSortDescending,
                    searchTerm = Model.Query.CurrentSearchTerm
                })">Next</a>
        }
    </div>
}
